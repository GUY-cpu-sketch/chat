<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>StartMyEducation — Admin Panel</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="adminContainer">
    <h1>Admin Panel</h1>

    <h2>Online Users</h2>
    <ul id="userList" class="userList"></ul>

    <h2>Whisper Logs</h2>
    <div id="whisperLogs" class="chatBox"></div>

    <div class="auth-box">
      <h2>Admin Commands</h2>
      <input id="targetUser" placeholder="Username" />
      <button id="kickBtn">Kick</button>
      <button id="banBtn">Ban</button>
      <input id="muteTime" type="number" placeholder="Mute time (sec)" />
      <button id="muteBtn">Mute</button>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    const userList = document.getElementById("userList");
    const whisperLogs = document.getElementById("whisperLogs");

    const targetUser = document.getElementById("targetUser");
    const kickBtn = document.getElementById("kickBtn");
    const banBtn = document.getElementById("banBtn");
    const muteBtn = document.getElementById("muteBtn");
    const muteTime = document.getElementById("muteTime");

    // auto-login admin
    socket.emit("login", { username: "DEV" });

    socket.on("updateUsers", (list) => {
      userList.innerHTML = list.map(u => `<li>${u}</li>`).join("");
    });

    socket.on("updateWhispers", (all) => {
      whisperLogs.innerHTML = "";
      all.forEach(w => {
        const time = new Date(w.time).toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });
        const p = document.createElement("p");
        p.innerHTML = `<span style="color:#aaa">[${time}]</span> <b>${w.from}</b> → <b>${w.to}</b>: ${w.message}`;
        whisperLogs.appendChild(p);
      });
    });

    kickBtn.addEventListener("click", () => {
      const target = targetUser.value.trim();
      if (!target) return alert("Enter a username");
      socket.emit("adminCommand", { cmd: "kick", target });
    });

    banBtn.addEventListener("click", () => {
      const target = targetUser.value.trim();
      if (!target) return alert("Enter a username");
      socket.emit("adminCommand", { cmd: "ban", target });
    });

    muteBtn.addEventListener("click", () => {
      const target = targetUser.value.trim();
      const time = muteTime.value || 60;
      if (!target) return alert("Enter a username");
      socket.emit("adminCommand", { cmd: "mute", target, arg: time });
    });

    socket.on("system", (msg) => {
      console.log("[SYSTEM]", msg);
    });
  </script>
</body>
</html>
